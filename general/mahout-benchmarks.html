<!DOCTYPE html>
<html lang=" en ">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>
    Mahout Benchmarks
    
  </title>

  <meta name="description" content="Distributed Linear Algebra">

  <link rel="stylesheet" href="/assets/css/main.css">

  <!-- Font Awesome -->
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Maven+Pro:400,500" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Muli:400,400i,700,700i" rel="stylesheet">

  <link rel="canonical" href="http://mahout.apache.org//general/mahout-benchmarks.html">
  <link rel="alternate" type="application/rss+xml" title="Apache Mahout" href="/feed.xml">


</head>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-98314020-1', 'auto');
  ga('send', 'pageview');
</script>

<body>

  <nav class="navbar navbar-expand-lg navbar-light bg-light navbar-mahout">

    <div class="container">

        <a class="navbar-brand" href="/">
          <img src="/assets/mahout-logo-blue.svg" alt="">
        </a>

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">

            <ul class="navbar-nav ml-auto">

                <!-- Download -->
                <li class="nav-item">
                    <a class="nav-link" href="/general/downloads">Download</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="/docs/latest/index.html">Overview</a>
                </li>

                <!-- Algorithms (Samsara / MR) -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Algorithms</a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                        <a class="dropdown-item"  href="/docs/latest/algorithms/linear-algebra">Distributed Linear Algebra</a>
                        <a class="dropdown-item"  href="/docs/latest/algorithms/preprocessors">Preprocessors</a>
                        <a class="dropdown-item"  href="/docs/latest/algorithms/regression">Regression</a>
                        <a class="dropdown-item"  href="/docs/latest/algorithms/clustering">Clustering</a>
                        <a class="dropdown-item"  href="/docs/latest/algorithms/recommenders">Recommenders</a>
                        <div class="dropdown-divider"></div>
                        <h6 class="dropdown-header">Deprecated</h6>
                        <a class="dropdown-item"  href="/docs/latest/algorithms/map-reduce">MapReduce <i>(deprecated)</i></a>
                    </div>
                    <!--<a class="dropdown-item"  href="/docs/latest/algorithms/recommenders/recommender-overview.html">Reccomender Overview</a></li> Do we still need? seems like short version of next post-->
                    <!--
                    <a class="dropdown-item"  href="/docs/latest/algorithms/recommenders/intro-cooccurrence-spark.html">Intro to Coocurrence With Spark</a></li>
                    <li role="separator" class="divider"></li>
                    <li><span>&nbsp;&nbsp;<a href="/docs/latest/algorithms/map-reduce"><b>MapReduce</b> (deprecated)</a><span></li>
                 -->
                </li>


                <!-- Developers -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Developers</a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                        <a class="dropdown-item" href="/developers/developer-resources.html">Developer Resources</a>
                        <a class="dropdown-item" href="/developers/buildingmahout">Building Mahout from Source</a>
                        <a class="dropdown-item" href="/developers/issue-tracker">Issues Tracking (JIRA)</a>
                        <!-- <a class="dropdown-item" href="/developers/patch-check-list/">Patch Check List</a> going to github template -->
                        <!-- <a class="dropdown-item" href="/developers/reference/">References</a> a lot of overlap with books, talks, etc. page -->
                        <a class="dropdown-item" href="/developers/release-notes">Release Notes</a>
                        <!-- <a class="dropdown-item" href="/developers/thirdparty-dependencies/">Third Party Dependencies</a> is our site the reasonable place for this? -->
                        <!-- <a class="dropdown-item" href="/developers/version-control/">Version Control</a> -->
                        <div class="dropdown-divider"></div>
                        <h6 class="dropdown-header">How To's</h6>
                        <a class="dropdown-item" href="/developers/how-to-contribute">How to Contribute</a>
                        <a class="dropdown-item" href="/developers/githubPRs">Github PRs</a>
                        <a class="dropdown-item" href="/developers/how-to-become-a-committer">How to Become a Committer</a>
                        <a class="dropdown-item" href="/developers/how-to-release">How to Release</a>
                        <a class="dropdown-item" href="/developers/how-to-update-the-website">How to Update the Website</a>
                    </div>
                </li>

                <!-- Docs -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Docs</a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                        <h6 class="dropdown-header">Release</h6>
                        <a class="dropdown-item" href="/docs/0.13.0">0.13.0</a>
                        <div class="dropdown-divider"></div>
                        <h6 class="dropdown-header">Latest Snapshot (Development)</h6>
                        <a class="dropdown-item" href="/docs/latest">0.13.1-SNAPSHOT</a>
                    </div>
                </li>

                <!-- Community -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Community</a>
                    <div class="dropdown-menu dropdown-menu-right">
                        <!--<a class="dropdown-item" href="/community/history/">History of the Apache Mahout Project</a>-->
                        <!--<a class="dropdown-item" href="/community/blogs/">Blog Posts About Mahout</a>-->
                        <!--<a class="dropdown-item" href="/community/recent-upcoming-talks/">Recent and Upcoming Talks</a>-->
                        <!-- <a class="dropdown-item" href="/community/books-tutorials-and-talks/">Books Tutorials and Talks</a> -->
                        <!-- <a class="dropdown-item" href="/community/faq/">FAQ</a> needs a lot of updating -->
                        <a class="dropdown-item" href="/developers/gsoc">GSoC</a>
                        <!-- Is OK- updated Map/Reduce verbage to reflect Samsara -->
                        <!-- <a class="dropdown-item" href="/community/mahout-benchmarks/">Mahout Benchmarks</a> These are old, Keep them? -->
                        <!-- <a class="dropdown-item" href="/community/mahout-wiki/">Mahout Wiki</a> at very least needs links cleanedup - do we still want this even?-->
                        <a class="dropdown-item" href="/general/mailing-lists">Mailing Lists</a>
                        <!-- Clean and pretty -->
                        <!-- <a class="dropdown-item" href="/community/powered-by-mahout/">Powered By Mahout</a> needs update -->
                        <a class="dropdown-item" href="/general/privacy-policy">Privacy Policy</a>
                        <!-- <a class="dropdown-item" href="/community/professional-support/">Professional Support</a> update if we even want to keep -->
                        <a class="dropdown-item" href="/general/who-we-are">Who We Are</a>
                        <!-- nikolai needs to add himself -->
                    </div>
                </li>

                <!-- GitHub -->
                <li class="nav-item">
                    <a class="nav-link" href="http://github.com/apache/mahout"><i class="fa fa-github"></i></a>
                </li>

            </ul>

            <!-- <form class="form-inline my-2 my-lg-0">
            <input class="form-control mr-sm-2" type="text" placeholder="Search" aria-label="Search">
            <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
        </form> -->

        </div>

    </div>

</nav>


  <p><a name="MahoutBenchmarks-Introduction"></a></p>
<h1 id="introduction">Introduction</h1>

<p>Depending on hardware configuration, exact distribution of ratings over users and items YMMV!</p>

<p><a name="MahoutBenchmarks-Recommenders"></a></p>
<h1 id="recommenders">Recommenders</h1>

<p><a name="MahoutBenchmarks-ARuleofThumb"></a></p>
<h2 id="a-rule-of-thumb">A Rule of Thumb</h2>

<p>100M preferences are about the data set size where non-distributed
recommenders will outgrow a normal-sized machine (32-bit, &lt;= 4GB RAM). Your
mileage will vary significantly with the nature of the data.</p>

<p><a name="MahoutBenchmarks-Distributedrecommendervs.Wikipedialinks(May272010)"></a></p>
<h2 id="distributed-recommender-vs-wikipedia-links-may-27-2010">Distributed recommender vs. Wikipedia links (May 27 2010)</h2>

<p>From the mailing list:</p>

<p>I just finished running a set of recommendations based on the Wikipedia
link graph, for book purposes (yeah, it’s unconventional). I ran on my
laptop, but it ought to be crudely representative of how it runs in a real
cluster.</p>

<p>The input is 1058MB as a text file, and contains, 130M article-article
associations, from 5.7M articles to 3.8M distinct articles (“users” and
“items”, respectively). I estimate cost based on Amazon’s North
American small Linux-based instance pricing of $0.085/hour. I ran on a
dual-core laptop with plenty of RAM, allowing 1GB per worker, so this is
valid.</p>

<p>In this run, I run recommendations for all 5.7M “users”. You can certainly
run for any subset of all users of course.</p>

<p>Phase 1 (Item ID to item index mapping)
29 minutes CPU time
$0.05
60MB output</p>

<p>Phase 2 (Create user vectors)
88 minutes CPU time
$0.13
Output: 1159MB</p>

<p>Phase 3 (Count co-occurrence)
77 hours CPU time
$6.54
Output: 23.6GB</p>

<p>Phase 4 (Partial multiply prep)
10.5 hours CPU time
$0.90
Output: 24.6GB</p>

<p>Phase 5 (Aggregate and recommend)
about 600 hours
about $51.00
about 10GB
(I estimated these rather than let it run at home for days!)</p>

<p>Note that phases 1 and 3 may be run less frequently, and need not be run
every time. But the cost is dominated by the last step, which is most of
the work. I’ve ignored storage costs.</p>

<p>This implies a cost of $0.01 (or about 8 instance-minutes) per 1,000 user
recommendations. That’s not bad if, say, you want to update recs for you
site’s 100,000 daily active users for a dollar.</p>

<p>There are several levers one could pull internally to sacrifice accuracy
for speed, but it’s currently set to pretty normal values. So this is just
one possibility.</p>

<p>Now that’s not terrible, but it is about 8x more computing than would be
needed by a non-distributed implementation <em>if</em> you could fit the whole
data set into a very large instance’s memory, which is still possible at
this scale but needs a pretty big instance. That’s a very apples-to-oranges
comparison of course; different algorithms, entirely different
environments. This is about the amount of overhead I’d expect from
distributing – interesting to note how non-trivial it is.</p>

<p><a name="MahoutBenchmarks-Non-distributedrecommendervs.KDDCupdataset(March2011)"></a></p>
<h2 id="non-distributed-recommender-vs-kdd-cup-data-set-march-2011">Non-distributed recommender vs. KDD Cup data set (March 2011)</h2>

<p>(From the user@mahout.apache.org mailing list)</p>

<p>I’ve been test-driving a simple application of Mahout recommenders (the
non-distributed kind) on Amazon EC2 on the new Yahoo KDD Cup data set
(kddcup.yahoo.com).</p>

<p>In the spirit of open-source, like I mentioned, I’m committing the extra
code to mahout-examples that can be used to run a Recommender on the input
and output the right format. And, I’d like to publish the rough timings
too. Find all the source in org.apache.mahout.cf.taste.example.kddcup</p>

<p><a name="MahoutBenchmarks-Track1"></a></p>
<h3 id="track-1">Track 1</h3>

<ul>
  <li>m2.2xlarge instance, 34.2GB RAM / 4 cores</li>
  <li>Steady state memory consumption: ~19GB</li>
  <li>Computation time: 30 hours (wall clock-time)</li>
  <li>CPU time per user: ~0.43 sec</li>
  <li>Cost on EC2: $34.20 (!)</li>
</ul>

<p>(Helpful hint on cost I realized after the fact: you can almost surely get
spot instances for cheaper. The maximum price this sort of instance has
gone for as a spot instance is about $0.60/hour, vs “retail price” of
$1.14/hour.)</p>

<p>Resulted in an RMSE of 29.5618 (the rating scale is 0-100), which is only
good enough for 29th place at the moment. Not terrible for “out of the box”
performance – it’s just using an item-based recommender with uncentered
cosine similarity. But not really good in absolute terms. A winning
solution is going to try to factor in time, and apply more sophisticated
techniques. The best RMSE so far is about 23.</p>

<p><a name="MahoutBenchmarks-Track2"></a></p>
<h3 id="track-2">Track 2</h3>

<ul>
  <li>c1.xlarge instance: 7GB RAM / 8 cores</li>
  <li>Steady state memory consumption: ~3.8GB</li>
  <li>Computation time: 4.1 hours (wall clock-time)</li>
  <li>CPU time per user: ~1.1 sec</li>
  <li>Cost on EC2: $3.20</li>
</ul>

<p>For this I bothered to write a simplistic item-item similarity metric to
take into account the additional info that is available: track, artist,
album, genre. The result was comparatively better: 17.92% error rate, good
enough for 4th place at the moment.</p>

<p>Of course, the next task is to put this through the actual distributed
processing – that’s really the appropriate solution.</p>

<p>This shows you can still tackle fairly impressive scale with a
non-distributed solution. These results suggest that the largest instances
available from EC2 would accommodate almost 1 billion ratings in memory.
However at that scale running a user’s full recommendations would easily be
measured in seconds, not milliseconds.</p>

<p><a name="MahoutBenchmarks-Clustering"></a></p>
<h1 id="clustering">Clustering</h1>

<p>See <a href="https://issues.apache.org/jira/browse/MAHOUT-588">MAHOUT-588</a></p>



  <footer class="footer bg-light">
    <div class="container text-center small">
        Copyright &copy; 2014-2020 The Apache Software Foundation, Licensed under the Apache License, Version 2.0.
    </div>
</footer>


  <script src="/assets/vendor/jquery/jquery-slim.min.js"></script>
  <script src="/assets/vendor/popper/popper.min.js"></script>
  <script src="/assets/vendor/bootstrap/js/bootstrap.min.js"></script>
  <script src="/assets/header.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

</body>

</html>
